# Create Service Function - Detailed Script

> **Status**: Generated from exploration
> **Last Updated**: 2026-01-23
> **Generated By**: Cursor AI exploration with Playwright MCP

## Parameters

- **name** (required): Name of the service to create

## Initial State

- User is logged in
- Browser can be on any page

## Actions

### Step 1: Navigate to Settings

- **Action**: Click
- **Target**: Settings menu item in sidebar

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `page.get_by_text('Settings')` | Simple, unique text | None |
| `page.locator('[data-nav="settings"]')` | Data attribute | May not exist |

**CHOSEN**: `page.get_by_text('Settings')` - Unique and simple.

**VERIFIED PLAYWRIGHT CODE**:
```python
page.get_by_text('Settings').click()
page.wait_for_url("**/app/settings", timeout=10000)
```

- **How verified**: Clicked in MCP, navigated to Settings page
- **Wait for**: URL contains "/app/settings"
- **Fallback locators**: `page.locator('[data-nav="settings"]')`

### Step 2: Click Services button

- **Action**: Click
- **Target**: Services section button in Settings

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='Define the services your')` | Unique button with descriptive text | Long selector |
| `iframe.get_by_text('Services')` | Simple | May match multiple elements |

**CHOSEN**: `iframe.get_by_role('button', name='Define the services your')` - Unique and semantic.

**VERIFIED PLAYWRIGHT CODE**:
```python
page.wait_for_selector('iframe[title="angularjs"]', timeout=10000)
iframe = page.frame_locator('iframe[title="angularjs"]')
iframe.get_by_role('button', name='Define the services your').click()
page.wait_for_url("**/app/settings/services", timeout=10000)
```

- **How verified**: Clicked in MCP, navigated to Services page
- **Wait for**: URL contains "/app/settings/services"
- **Fallback locators**: `iframe.get_by_role('heading', name='Services')`

### Step 3: Click New Service dropdown

- **Action**: Click
- **Target**: "New service" dropdown button

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='New service icon-caret-down')` | Unique, includes icon name | None |
| `iframe.get_by_text('New service')` | Simple | May match other elements |

**CHOSEN**: `iframe.get_by_role('button', name='New service icon-caret-down')` - Unique identifier.

**VERIFIED PLAYWRIGHT CODE**:
```python
new_service_btn = iframe.get_by_role('button', name='New service icon-caret-down')
new_service_btn.click()
menu = iframe.get_by_role('menu')
menu.wait_for(state='visible', timeout=5000)
```

- **How verified**: Clicked in MCP, dropdown menu appeared
- **Wait for**: Menu becomes visible
- **Fallback locators**: `iframe.get_by_text('New service')`

### Step 4: Select 1 on 1 appointment

- **Action**: Click
- **Target**: "1 on 1 appointment" menu item

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('menuitem', name='on 1 appointment')` | Semantic, unique | Partial name match |
| `iframe.get_by_text('1 on 1 appointment')` | Full text | May not work as menu item |

**CHOSEN**: `iframe.get_by_role('menuitem', name='on 1 appointment')` - Semantic and verified.

**VERIFIED PLAYWRIGHT CODE**:
```python
one_on_one_option = iframe.get_by_role('menuitem', name='on 1 appointment')
one_on_one_option.click()
dialog = iframe.get_by_role('dialog')
dialog.wait_for(state='visible', timeout=10000)
```

- **How verified**: Clicked in MCP, dialog appeared
- **Wait for**: Dialog becomes visible
- **Fallback locators**: `iframe.get_by_text('1 on 1 appointment')`

### Step 5: Enter Service Name

- **Action**: Type
- **Target**: Service name field
- **Value**: `{name}`

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('textbox', name='Service name *')` | Semantic, accessible | None |
| `iframe.locator('input[name="service_name"]')` | Direct selector | May not exist |

**CHOSEN**: `iframe.get_by_role('textbox', name='Service name *')` - Semantic and verified.

**VERIFIED PLAYWRIGHT CODE**:
```python
name_field = iframe.get_by_role('textbox', name='Service name *')
name_field.click()
page.wait_for_timeout(100)
name_field.press_sequentially(name, delay=30)
```

- **How verified**: Typed in MCP, value appeared in field
- **Fallback locators**: `iframe.locator('input[placeholder*="Service name"]')`

### Step 6: Select Face to Face Location

- **Action**: Click
- **Target**: "Face to face" location button

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='icon-Home Face to face')` | Unique with icon | None |
| `iframe.get_by_text('Face to face')` | Simple | May match label |

**CHOSEN**: `iframe.get_by_role('button', name='icon-Home Face to face')` - Unique button.

**VERIFIED PLAYWRIGHT CODE**:
```python
face_to_face_btn = iframe.get_by_role('button', name='icon-Home Face to face')
face_to_face_btn.click()
# Address radio group appears - "My business address" is selected by default
```

- **How verified**: Clicked in MCP, button became active
- **Wait for**: Radio group appears (optional, default selected)
- **Fallback locators**: `iframe.get_by_text('Face to face')`

### Step 7: Select No Fee (Free Service)

- **Action**: Click
- **Target**: "No fee" pricing button

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='No fee')` | Unique, semantic | None |
| `iframe.locator('button:has-text("No fee")')` | CSS selector | Less semantic |

**CHOSEN**: `iframe.get_by_role('button', name='No fee')` - Unique and simple.

**VERIFIED PLAYWRIGHT CODE**:
```python
no_fee_btn = iframe.get_by_role('button', name='No fee')
no_fee_btn.click()
```

- **How verified**: Clicked in MCP, button became active
- **Fallback locators**: `iframe.locator('button:has-text("No fee")')`

### Step 8: Click Create Button

- **Action**: Click
- **Target**: Create button in dialog

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='Create')` | Unique, semantic | None |
| `iframe.locator('button:has-text("Create")')` | CSS selector | Less semantic |

**CHOSEN**: `iframe.get_by_role('button', name='Create')` - Unique button in dialog.

**VERIFIED PLAYWRIGHT CODE**:
```python
dialog = iframe.get_by_role('dialog')
create_btn = iframe.get_by_role('button', name='Create')
create_btn.click()
dialog.wait_for(state='hidden', timeout=15000)
```

- **How verified**: Clicked in MCP, dialog closed
- **Wait for**: Dialog becomes hidden
- **Fallback locators**: `iframe.locator('.dialog-actions button:has-text("Create")')`

### Step 9: Refresh Services List

- **Action**: Navigate away and back
- **Target**: Settings menu and Services button
- **Note**: BUG WORKAROUND - list doesn't auto-refresh after creation

**VERIFIED PLAYWRIGHT CODE**:
```python
# BUG WORKAROUND: Navigate away and back to refresh the list
settings_menu = page.get_by_text('Settings', exact=True)
settings_menu.click()
page.wait_for_url("**/app/settings", timeout=10000)

# Re-acquire iframe and navigate back to Services
angular_iframe = page.locator('iframe[title="angularjs"]')
angular_iframe.wait_for(state='visible', timeout=10000)
iframe = page.frame_locator('iframe[title="angularjs"]')
services_btn = iframe.get_by_role('button', name='Define the services your')
services_btn.click()
page.wait_for_url("**/app/settings/services", timeout=10000)
```

- **How verified**: Service appeared in list after refresh
- **Wait for**: Services page loads

### Step 10: Click on Service to Get ID

- **Action**: Click
- **Target**: The newly created service in the list

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button').filter(has_text=name)` | Dynamic, matches by name | None |
| `iframe.locator(f'button:has-text("{name}")')` | CSS selector | Less semantic |

**CHOSEN**: `iframe.get_by_role('button').filter(has_text=name)` - Dynamic matching.

**VERIFIED PLAYWRIGHT CODE**:
```python
service_in_list = iframe.get_by_role('button').filter(has_text=name)
service_in_list.wait_for(state='visible', timeout=10000)
service_in_list.click()
page.wait_for_url("**/app/settings/services/**", timeout=10000)
```

- **How verified**: Clicked in MCP, navigated to service edit page
- **Wait for**: URL contains service ID

### Step 11: Extract Service ID from URL

- **Action**: Extract
- **Target**: Service ID from URL pattern

**VERIFIED PLAYWRIGHT CODE**:
```python
import re
url = page.url
service_id_match = re.search(r'/services/([a-z0-9]+)', url)
service_id = service_id_match.group(1) if service_id_match else None
```

- **How verified**: Extracted ID "3j5uwb34cjex52jl" from URL
- **Save to context**: `created_service_id`, `created_service_name`

### Step 12: Navigate Back to Services List

- **Action**: Navigate
- **Target**: Services list page via Settings

**VERIFIED PLAYWRIGHT CODE**:
```python
settings_menu = page.get_by_text('Settings', exact=True)
settings_menu.click()
page.wait_for_url("**/app/settings", timeout=10000)

angular_iframe = page.locator('iframe[title="angularjs"]')
angular_iframe.wait_for(state='visible', timeout=10000)
iframe = page.frame_locator('iframe[title="angularjs"]')
services_btn = iframe.get_by_role('button', name='Define the services your')
services_btn.click()
page.wait_for_url("**/app/settings/services", timeout=10000)

services_heading = iframe.get_by_role('heading', name='Settings / Services')
services_heading.wait_for(state='visible', timeout=10000)
```

- **How verified**: Navigated back to Services list
- **Wait for**: Services heading visible

## Success Verification

- Service appears in the services list
- Service ID is captured from URL
- Context contains `created_service_id` and `created_service_name`
