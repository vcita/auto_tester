# vcita Test Agent - Functions Registry
# 
# This file lists all reusable functions available for tests.
# Each function must have a corresponding folder with steps.md, script.md, test.py, and changelog.md

functions:
  - id: login
    name: Login to vcita
    description: Authenticate a user into the vcita system
    parameters:
      - name: username
        type: string
        required: true
        description: The username/email to login with
      - name: password
        type: string
        required: true
        description: The password for the account
    returns:
      - name: logged_in_user
        description: The username that was successfully logged in

  - id: logout
    name: Logout from vcita
    description: Log out the current user from the system
    parameters: []
    returns: []

  - id: create_service
    name: Create Service
    description: Create a minimal 1-on-1 service for test setup purposes
    parameters:
      - name: name
        type: string
        required: false
        description: Name of the service (defaults to "Test Service {timestamp}")
    returns:
      - name: created_service_id
        description: ID of the created service
      - name: created_service_name
        description: Name of the created service

  - id: delete_service
    name: Delete Service
    description: Delete a service by name for test teardown
    parameters:
      - name: name
        type: string
        required: false
        description: Name of the service to delete (defaults to context value)
    returns: []

  - id: create_client
    name: Create Client
    description: Create a minimal client (matter/property) for test setup purposes
    parameters:
      - name: first_name
        type: string
        required: false
        description: First name of the client (defaults to "Test")
      - name: last_name
        type: string
        required: false
        description: Last name of the client (defaults to "Client{timestamp}")
      - name: email
        type: string
        required: false
        description: Email address (defaults to generated test email)
    returns:
      - name: created_client_id
        description: ID of the created client
      - name: created_client_name
        description: Full name of the client
      - name: created_client_email
        description: Email of the client

  - id: create_user
    name: Create User (and onboard)
    description: Create a new vcita user via signup, dismiss one-time setup dialogs, and validate no dialog on second login. Use onboarding_only=true to only run dismiss+validate for an existing new user.
    parameters:
      - name: email
        type: string
        required: true
        description: New user email
      - name: password
        type: string
        required: false
        description: Password (default vcita123)
      - name: name
        type: string
        required: false
        description: Your Name or Business Name (default Test User {timestamp})
      - name: base_url
        type: string
        required: false
        description: Target base URL (from config/context); login URL = base_url + "/login"
      - name: onboarding_only
        type: boolean
        required: false
        description: If true, skip signup and only login + dismiss dialogs + validate
      - name: phone
        type: string
        required: false
        description: Phone for first-time Welcome dialog (server-validated). Default VCITA_TEST_PHONE or 5550100
    returns:
      - name: created_user_email
        description: The email used
      - name: created_user_ready
        description: True when validation passed

  - id: delete_client
    name: Delete Client
    description: Delete a client (matter/property) by name for test teardown
    parameters:
      - name: name
        type: string
        required: false
        description: Name of the client to delete (defaults to context value)
      - name: id
        type: string
        required: false
        description: ID of the client to delete (defaults to context value)
    returns: []
