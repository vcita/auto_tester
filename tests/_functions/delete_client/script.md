# Delete Client Function - Detailed Script

> **Status**: Generated from exploration
> **Last Updated**: 2026-01-23
> **Generated By**: Cursor AI exploration with Playwright MCP

## Parameters

- **name** (optional): Name of the client to delete
- **id** (optional): ID of the client to delete

## Initial State

- User is logged in
- Browser can be on any page

## Actions

### Step 1: Navigate to Matter List

- **Action**: Click
- **Target**: Matter list menu item in sidebar (label varies: "Properties", "Clients", "Patients", "Students", "Pets")

**Entity-agnostic**: Use sidebar position (same as delete_matter) so the test works for any vertical. Do NOT use `get_by_text('Properties')` â€” that fails when the vertical uses "Clients" or "Patients".

**CHOSEN**: `page.locator(".menu-items-group > div:nth-child(4)")` - Position-based, entity-agnostic.

**VERIFIED PLAYWRIGHT CODE**:
```python
matter_list_nav = page.locator(".menu-items-group > div:nth-child(4)")
matter_list_nav.wait_for(state="visible", timeout=10000)
matter_list_nav.click()
page.wait_for_url("**/app/clients", timeout=10000)
```

- **Wait for**: URL contains "/app/clients"

### Step 2: Search for Client

- **Action**: Type
- **Target**: Search field
- **Value**: `{name}`

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `page.get_by_role('searchbox', name='Search by name, email, or phone number')` | Full accessible name | None |

**CHOSEN**: `page.get_by_role('searchbox', name='Search by name, email, or phone number')` - Unique.

**VERIFIED PLAYWRIGHT CODE**:
```python
search_field = page.get_by_role('searchbox', name='Search by name, email, or phone number')
search_field.click()
page.wait_for_timeout(100)
search_field.press_sequentially(name, delay=30)
page.wait_for_timeout(1000)  # Allow search results to update
```

- **How verified**: Verified in MCP
- **Wait for**: Search results filtered

### Step 3: Click on Client in List

- **Action**: Click
- **Target**: Client row in the search results

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `page.get_by_role('row').filter(has_text=name)` | Dynamic matching | None |

**CHOSEN**: `page.get_by_role('row').filter(has_text=name)` - Flexible matching.

**VERIFIED PLAYWRIGHT CODE**:
```python
client_row = page.get_by_role('row').filter(has_text=name)
client_row.wait_for(state='visible', timeout=5000)
client_row.click()
page.wait_for_url("**/app/clients/**", timeout=10000)
```

- **How verified**: Clicked in MCP, navigated to client detail page
- **Wait for**: URL contains client ID

### Step 4: Click More Dropdown

- **Action**: Click
- **Target**: "More" dropdown button

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='More icon-caret-down')` | Unique, includes icon name | None |

**CHOSEN**: `iframe.get_by_role('button', name='More icon-caret-down')` - Unique button.

**VERIFIED PLAYWRIGHT CODE**:
```python
page.wait_for_selector('iframe[title="angularjs"]', timeout=10000)
iframe = page.frame_locator('iframe[title="angularjs"]')
more_btn = iframe.get_by_role('button', name='More icon-caret-down')
more_btn.wait_for(state='visible', timeout=10000)
more_btn.click()
menu = iframe.get_by_role('menu')
menu.wait_for(state='visible', timeout=5000)
```

- **How verified**: Clicked in MCP, dropdown menu appeared
- **Wait for**: Menu becomes visible

### Step 5: Select Delete &lt;entity&gt;

- **Action**: Click
- **Target**: "Delete property" / "Delete client" / "Delete patient" menu item (text varies by vertical)

**Entity-agnostic**: Menuitem name is "Delete property", "Delete client", "Delete patient", etc. Use filter with regex.

**CHOSEN**: `iframe.get_by_role("menuitem").filter(has_text=re.compile(r"^Delete ", re.IGNORECASE)).first`

**VERIFIED PLAYWRIGHT CODE**:
```python
delete_option = iframe.get_by_role("menuitem").filter(has_text=re.compile(r"^Delete ", re.IGNORECASE))
delete_option.first.click()
dialog = iframe.get_by_role('dialog')
dialog.wait_for(state='visible', timeout=5000)
```

- **Wait for**: Dialog becomes visible

### Step 6: Confirm Deletion

- **Action**: Click
- **Target**: "Ok" button in confirmation dialog

**LOCATOR DECISION:**

| Option | Pros | Cons |
|--------|------|------|
| `iframe.get_by_role('button', name='Ok')` | Unique in dialog | None |

**CHOSEN**: `iframe.get_by_role('button', name='Ok')` - Unique.

**VERIFIED PLAYWRIGHT CODE**:
```python
ok_btn = iframe.get_by_role('button', name='Ok')
ok_btn.click()
page.wait_for_url("**/app/clients", timeout=10000)
```

- **How verified**: Would redirect to Properties list after deletion
- **Wait for**: URL is Properties list (no client ID)

## Success Verification

- Redirected to Properties list
- Client no longer in search results (optional verification)
- Context variables cleared
